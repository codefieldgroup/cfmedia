"use strict";angular.module("cf",["ngFileUpload"]).directive("cfmedia",[function(){return{restrict:"A",replace:!0,transclude:!0,require:"?ngModel",scope:{model:"=ngModel",headTitle:"@?head",apiUrl:"@?api",srcUrl:"@?url",multiple:"=?multiple",returnModel:"@?return",accept:"@?",order:"@?",filter:"@?"},templateUrl:"cfmedia.html",link:function(a,b){a.openMediaModal=function(){b.find(".cfmedia-modal").modal()},a.selectSave=function(){b.find(".cfmedia-modal").modal("hide")}},controller:["$scope","$timeout","Upload","Media",function(a,b,c,d){if(a.apiUrl=angular.isDefined(a.apiUrl)?a.apiUrl:"api/media",a.srcUrl=angular.isDefined(a.srcUrl)?a.srcUrl:"/public/upload/",a.elementsSelected=[],a.params={limit:10,offset:0,search:""},a.apiUrl){a.progress=0;{angular.copy(a.model)}a.$watch("modelUpload",function(){a.modelUpload&&a.upload(a.modelUpload)}),a.upload=function(b){angular.forEach(b,function(b){a.progress="",c.upload({url:a.apiUrl,fields:{},file:b}).progress(function(b){var c=parseInt(100*b.loaded/b.total);a.progress=c}).success(function(b){a.elements.push(b)}).error(function(a,b){console.log("error status: "+b)})})},a.select=function(b,c){is.not.inArray(b,a.elementsSelected)?a.multiple?(b.activeClass=!0,a.elementsSelected.push(b)):(angular.forEach(a.elements,function(b,c){a.elements[c].activeClass=!1}),b.activeClass=!0,a.elementsSelected=[],a.elementsSelected.push(b)):angular.forEach(a.elementsSelected,function(d,e){d==b&&(a.elements[c].activeClass=!1,a.elementsSelected.splice(e,1))})},a.openMediaModalCtrl=function(){a.multiple=angular.isDefined(a.multiple)?a.multiple:!0,a.headTitle=angular.isDefined(a.headTitle)?a.headTitle:"Change Imagen",a.returnModel=angular.isDefined(a.returnModel)?a.returnModel:"object",a.accept=angular.isDefined(a.accept)?a.accept:"image/*",a.order=angular.isDefined(a.order)?a.order:"date",a.filter=angular.isDefined(a.filter)?a.filter:"meta",a.params={limit:10,offset:0,search:""},a.elementsSelected=[],a.elements=[],d.getAll({limit:a.params.limit,offset:a.params.offset,search:a.params.search},function(b){a.elements=angular.copy(b)})},a.selectSaveCtrl=function(){a.elementsSelected.length>0?a.multiple?"string"==a.returnModel?angular.forEach(a.elementsSelected,function(b){a.model.push(b.meta)}):"object"==a.returnModel&&(a.model=a.elementsSelected):"string"==a.returnModel?a.model=a.elementsSelected[0].meta:"object"==a.returnModel&&(a.model=a.elementsSelected[0]):alert("Please select one element.")},a.loadMore=function(){a.params.offset=0==a.params.offset?a.params.offset+a.params.limit:a.params.offset+a.params.offset,d.getAll({limit:a.params.limit,offset:a.params.offset,search:a.params.search},function(b){b.length>0?angular.forEach(b,function(b){a.elements.push(b)}):alert("No more elements in DB.")})},a.$watch("search",function(b){a.params.search=b,a.params.offset=0,d.getAll({limit:a.params.limit,offset:a.params.offset,search:a.params.search},function(b){b.length>0?a.elements=angular.copy(b):alert("No more elements in DB.")})})}}]}}]);
//# sourceMappingURL=cfmedia.min.js.map